# 基于YOLOv11的猫狗图像种类检测与分类

本项目基于 **YOLOv11-L** 框架，构建了一个面向猫狗品种识别任务的完整训练与测试系统，  
支持多模型融合、推理增强（TTA）、性能自动计算与可视化输出。  
通过自定义数据平衡与优化策略，实现了在多类别检测场景下的高精度与强鲁棒性。

## 功能概览

| 功能模块 | 说明 |
|-----------|------|
| **模型训练** | 自动断点续训、超参数优化、动态日志保存 |
| **数据增强** | Mosaic / MixUp / CopyPaste / Label Smoothing / Dropout |
| **样本平衡** | 自定义 `balance_dataset()`，自动过采样稀有类别 |
| **多模型融合** | Weighted Boxes Fusion (WBF) + IoU 抑制 |
| **测试增强 (TTA)** | 水平翻转推理增强，提升鲁棒性与 mAP |
| **性能评估** | 自动计算 Precision / Recall / F1 / mAP |
| **可视化输出** | 双子图（Per-Class 曲线 + 平均指标柱状图） |
| **断点恢复** | 自动检测 `last.pt` 实现 resume 训练 |

## 算法亮点

### 1 多模型融合（Weighted Boxes Fusion）
- 对多个模型输出的边界框按置信度加权；
- 减少重复检测与冲突框；
- 在保留细节的同时提升整体稳定性。

### 2 推理时增强（Test-Time Augmentation, TTA）
- 对输入图像进行**水平翻转**；
- 将原图与翻转预测结果反变换后融合；
- 对光照、角度、姿态变化具有更强鲁棒性；
- 可提升 mAP 约 **1–2%**。

### 3 正则化策略
- **Label Smoothing (0.05)**：防止过拟合；
- **Dropout (0.05)**：提升泛化能力；
- **Weight Decay (0.0005)**：抑制过大权重。

### 4 自动性能可视化
- 左图：各类别 Precision / Recall / mAP 曲线；
- 右图：平均指标柱状图；
- 自动标注平均值，与 YOLO 官方日志 **完全对齐**。

## 数据来源与标注

### 数据来源
本项目的数据集来自以下多个渠道，以确保多样性与泛化性：

- 助教提供的课程数据集  
- **Kaggle** 开源猫狗图像集  
- **Istockphoto** 商业授权图像  
- **视觉中国** 高分辨率样本  

### 数据标注
- **标注平台**：使用 [Roboflow](https://roboflow.com/) 进行高效标注与自动格式转换。  
- **标注格式**：采用 **YOLO 格式 (TXT)**，包含类别 ID 与归一化坐标。
  
### 数据增强策略
- **随机裁剪（Crop）**：模拟视角变化，提高鲁棒性；  
- **亮度调整（Exposure）**：增强对光照条件变化的适应能力。  

### 数据扩充
- 原始样本经增强后扩充至 **原始数量 × 3**，以减轻样本稀疏类别的不平衡问题。

### 类别分布

| 类别名称 | 标签代号 |
|-----------|-----------|
| 布偶猫 | `cat_bo` |
| 孟买猫 | `cat_mm` |
| 奶牛猫 | `cat_nn` |
| 玳瑁虎纹猫 | `cat_hw` |
| 橘猫 | `cat_jm` |
| 土耳其梵猫 | `cat_teq` |
| 比格犬 | `dog_bige` |
| 贵宾犬 | `dog_guibing` |
| 哈巴狗 | `dog_habar` |
| 哈士奇 | `dog_hsq` |
| 阿拉斯加犬 | `dog_alsj` |
| 大白熊犬 | `dog_dbx` |
| 萨摩耶 | `dog_smy` |

**说明**：  
数据集在标注与扩充过程中保持了统一的分辨率与标注精度。各类别在增强后样本数量趋于均衡，为后续的训练与验证提供了良好的数据基础。

本项目遵循 MIT License  
如在学术场合使用，请引用本仓库链接或作者信息。
